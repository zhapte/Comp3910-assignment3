<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="jakarta.faces.html"
      xmlns:f="jakarta.faces.core"
      xmlns:ui="jakarta.faces.facelets">

<ui:composition template="/templates/app.xhtml">
  <ui:define name="title">#{msgs.changePassword}</ui:define>

  <f:metadata>
    <f:viewAction action="#{loginBean.ensureLoggedIn}" />
  </f:metadata>

  <ui:define name="sidebar">
    <ui:include src="/sections/sidebar.xhtml"/>
  </ui:define>

  <ui:define name="content">
    <h1>#{msgs.changePassword}</h1>

    <h:messages globalOnly="true" showDetail="true" style="margin-bottom:1rem; color:#c00" />

    <h:form id="changePwForm">
      <div class="form-row">
        <label for="current">#{msgs.changePasswordCurrent}</label>
        <h:inputSecret id="current"
                       value="#{changePasswordBean.currentPw}"
                       required="true"
                       requiredMessage="Please enter your current password." />
        <h:message for="current" style="color:#c00"/>
      </div>

      <div class="form-row">
        <label for="new">#{msgs.changePasswordNew}</label>
        <h:inputSecret id="new"
                       value="#{changePasswordBean.newPw}"
                       required="true"
                       requiredMessage="Please enter a new password." />
        <h:message for="new" style="color:#c00"/>
      </div>

      <div class="form-row">
        <label for="confirm">Confirm New Password</label>
        <h:inputSecret id="confirm"
                       value="#{changePasswordBean.confirmPw}"
                       required="true"
                       requiredMessage="Please confirm your new password." />
        <h:message for="confirm" style="color:#c00"/>
      </div>

      <div class="form-actions" style="margin-top:1rem; display:flex; gap:.5rem;">
        <h:commandButton value="Change Password"
                         action="#{changePasswordBean.changePassword}"
                         styleClass="btn btn-primary" />
      </div>
    </h:form>
  </ui:define>
</ui:composition>
</html>
